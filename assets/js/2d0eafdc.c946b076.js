"use strict";(self.webpackChunkio_t_2024_1=self.webpackChunkio_t_2024_1||[]).push([[108],{9316:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var r=i(5893),t=i(1151);i(3992),i(425),i(9372);const s={sidebar_label:"Ejemplo 1"},o="Ejemplo 1",l={id:"sesiones/percepcion/sesion9b_2_1",title:"Ejemplo 1",description:"Enunciado",source:"@site/docs/sesiones/percepcion/sesion9b_2_1.md",sourceDirName:"sesiones/percepcion",slug:"/sesiones/percepcion/sesion9b_2_1",permalink:"/IoT_2024-1/docs/sesiones/percepcion/sesion9b_2_1",draft:!1,unlisted:!1,editUrl:"https://github.com/UdeA-IoT/IoT_2024-1/tree/main/packages/create-docusaurus/templates/shared/docs/sesiones/percepcion/sesion9b_2_1.md",tags:[],version:"current",frontMatter:{sidebar_label:"Ejemplo 1"},sidebar:"sesionesSidebar",previous:{title:"Introducci\xf3n",permalink:"/IoT_2024-1/docs/sesiones/percepcion/sesion9b_2"},next:{title:"Interrupciones por timer",permalink:"/IoT_2024-1/docs/sesiones/percepcion/sesion9b_3"}},a={},c=[{value:"Enunciado",id:"enunciado",level:2},{value:"Codigo polling",id:"codigo-polling",level:2},{value:"Codigo interrupciones con problemas de rebote",id:"codigo-interrupciones-con-problemas-de-rebote",level:2},{value:"Codigo interrupciones con el problema solucionado",id:"codigo-interrupciones-con-el-problema-solucionado",level:2},{value:"Referencias",id:"referencias",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"ejemplo-1",children:"Ejemplo 1"}),"\n",(0,r.jsx)(n.h2,{id:"enunciado",children:"Enunciado"}),"\n",(0,r.jsx)(n.p,{children:"Hacer una aplicaci\xf3n que cambie el estado de un led cada vez que se presiona un boton."}),"\n",(0,r.jsx)(n.h2,{id:"codigo-polling",children:"Codigo polling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'#define SERIAL_SPEED 9600\r\n\r\nconst int buttonPin = 12;\r\nconst int ledPin = 25;  \r\n\r\nint buttonState, prev_buttonState;\r\nint ledState;\r\n\r\nunsigned long last_DebounceTime = 0;\r\nunsigned long debounce_delay = 10;\r\n\r\nvoid setup() {\r\n  // Configuracion de puertos\r\n  pinMode(ledPin, OUTPUT);\r\n  Serial.begin(SERIAL_SPEED);\r\n  // Inicializacion de variables\r\n  buttonState = 0;\r\n  ledState = LOW;\r\n  digitalWrite(ledPin, ledState);\r\n  prev_buttonState = buttonState;\r\n  // Iniciacion del puerto serial  \r\n  Serial.println("Inicio...");\r\n}\r\n\r\nvoid loop() {\r\n  buttonState = digitalRead(buttonPin);\r\n  delay(debounce_delay);\r\n  if (buttonState != prev_buttonState) {\r\n    // Transici\xf3n (positiva o negativa)\r\n    // Serial.println("[T]");\r\n    if (buttonState == HIGH) {\r\n      // Transici\xf3n positiva\r\n      Serial.print("[T+]-> Led:");\r\n      Serial.println(ledState);\r\n      ledState = !ledState;\r\n      digitalWrite(ledPin, ledState);\r\n    }\r\n  }\r\n  prev_buttonState = buttonState;\r\n}\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Simulaci\xf3n online"}),"\r\nEn el siguiente ",(0,r.jsx)(n.a,{href:"https://wokwi.com/projects/387861640702724097",children:"link"})," puede simular el c\xf3digo para comprender su funcionamiento."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Nota"}),": hacer la soluci\xf3n alternativa usando la funci\xf3n ",(0,r.jsx)(n.code,{children:"millis()"})," que es mas eficiente."]}),"\n",(0,r.jsx)(n.h2,{id:"codigo-interrupciones-con-problemas-de-rebote",children:"Codigo interrupciones con problemas de rebote"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Ver si el boton no tiene rebote"}),"\n",(0,r.jsx)(n.li,{children:"Ver que falla cuando el boton presenta rebote"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#define SERIAL_SPEED 9600\r\n\r\nconst int buttonPin = 12;\r\nconst int ledPin = 25;  \r\n\r\nint ledState;\r\nvolatile bool led_change;\r\n\r\nvoid IRAM_ATTR button_ISR() {\r\n  led_change = true;\r\n}\r\n\r\nvoid setup() {\r\n  // Configuracion de puertos\r\n  pinMode(ledPin, OUTPUT);\r\n  Serial.begin(SERIAL_SPEED);\r\n  // Inicializacion de variables\r\n  led_change = false;\r\n  ledState = LOW;\r\n  digitalWrite(ledPin, ledState);\r\n  attachInterrupt(digitalPinToInterrupt(buttonPin), button_ISR, RISING);\r\n  // Iniciacion del puerto serial  \r\n  Serial.println("Inicio...");\r\n}\r\n\r\nvoid loop() {\r\n  if (led_change == true) {\r\n    // Transici\xf3n positiva\r\n    Serial.print("[T+]-> Led:");\r\n    Serial.println(ledState);\r\n    ledState = !ledState;\r\n    digitalWrite(ledPin, ledState);\r\n    led_change = false;\r\n  }\r\n}\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Simulaci\xf3n online"}),"\r\nEn el siguiente ",(0,r.jsx)(n.a,{href:"https://wokwi.com/projects/387862205667175425",children:"link"})," puede simular el c\xf3digo para comprender su funcionamiento."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"codigo-interrupciones-con-el-problema-solucionado",children:"Codigo interrupciones con el problema solucionado"}),"\n",(0,r.jsx)(n.p,{children:"No es el mejor c\xf3digo, pero funciona."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#define SERIAL_SPEED 9600\r\n\r\nconst int buttonPin = 12;\r\nconst int ledPin = 25;  \r\n\r\nint ledState;\r\n\r\nvolatile bool led_change;\r\n\r\nunsigned long last_DebounceTime = 0;\r\nunsigned long debounce_delay = 70; // Probar con varios valores \r\n                                   // hasta que funcione (10, 20,...)\r\n\r\n\r\nvoid IRAM_ATTR button_ISR() {\r\n  if(millis() - last_DebounceTime > debounce_delay){ \r\n    // Software debouncing buton\r\n    // ets_printf("ISR triggered\\n");\r\n    led_change = true;\r\n }\r\n last_DebounceTime = millis();\r\n}\r\n\r\nvoid setup() {\r\n  // Configuracion de puertos\r\n  pinMode(ledPin, OUTPUT);\r\n  Serial.begin(SERIAL_SPEED);\r\n  // Inicializacion de variables\r\n  led_change = false;\r\n  ledState = LOW;\r\n  digitalWrite(ledPin, ledState);\r\n  attachInterrupt(digitalPinToInterrupt(buttonPin), button_ISR, RISING);\r\n  // Iniciacion del puerto serial  \r\n  Serial.println("Inicio...");\r\n}\r\n\r\nvoid loop() {\r\n  if (led_change == true) {\r\n    // Transici\xf3n positiva\r\n    Serial.print("[T+]-> Led:");\r\n    Serial.println(ledState);\r\n    ledState = !ledState;\r\n    digitalWrite(ledPin, ledState);\r\n    led_change = false;\r\n  }\r\n}\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Simulaci\xf3n online"}),"\r\nEn el siguiente ",(0,r.jsx)(n.a,{href:"https://wokwi.com/projects/387864147969036289",children:"link"})," puede simular el c\xf3digo para comprender su funcionamiento."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"referencias",children:"Referencias"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.theengineeringprojects.com/2021/12/esp32-interrupts.html",children:"https://www.theengineeringprojects.com/2021/12/esp32-interrupts.html"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.upesy.com/blogs/tutorials/what-are-interrupts-in-esp32-with-examples-for-arduino-code",children:"https://www.upesy.com/blogs/tutorials/what-are-interrupts-in-esp32-with-examples-for-arduino-code"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://deepbluembedded.com/esp32-external-interrupts-pins-arduino-examples/#google_vignette",children:"https://deepbluembedded.com/esp32-external-interrupts-pins-arduino-examples/#google_vignette"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://programarfacil.com/blog/arduino-blog/interrupciones-con-arduino-ejemplo-practico/",children:"https://programarfacil.com/blog/arduino-blog/interrupciones-con-arduino-ejemplo-practico/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.luisllamas.es/que-son-y-como-usar-interrupciones-en-arduino/",children:"https://www.luisllamas.es/que-son-y-como-usar-interrupciones-en-arduino/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.espressif.com/projects/esp-idf/en/v4.3/esp32/api-reference/peripherals/timer.html",children:"https://docs.espressif.com/projects/esp-idf/en/v4.3/esp32/api-reference/peripherals/timer.html"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.espressif.com/sites/default/files/documentation/esp32_datasheet_en.pdf",children:"https://www.espressif.com/sites/default/files/documentation/esp32_datasheet_en.pdf"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.espressif.com/sites/default/files/documentation/esp32_technical_reference_manual_en.pdf#iomuxgpio",children:"https://www.espressif.com/sites/default/files/documentation/esp32_technical_reference_manual_en.pdf#iomuxgpio"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.ai-thinker.com/_media/esp32/docs/nodemcu-32s_product_specification.pdf",children:"https://docs.ai-thinker.com/_media/esp32/docs/nodemcu-32s_product_specification.pdf"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/hw-reference/index.html",children:"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/hw-reference/index.html"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.upesy.com/blogs/tutorials/what-are-interrupts-in-esp32-with-examples-for-arduino-code",children:"https://www.upesy.com/blogs/tutorials/what-are-interrupts-in-esp32-with-examples-for-arduino-code"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://esphome.io/devices/nodemcu_esp32.html",children:"https://esphome.io/devices/nodemcu_esp32.html"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://randomnerdtutorials.com/esp32-pir-motion-sensor-interrupts-timers/",children:"https://randomnerdtutorials.com/esp32-pir-motion-sensor-interrupts-timers/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://randomnerdtutorials.com/micropython-interrupts-esp32-esp8266/",children:"https://randomnerdtutorials.com/micropython-interrupts-esp32-esp8266/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://learn.sparkfun.com/tutorials/processor-interrupts-with-arduino/all",children:"https://learn.sparkfun.com/tutorials/processor-interrupts-with-arduino/all"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/sparkfun/processor_interrupt_examples",children:"https://github.com/sparkfun/processor_interrupt_examples"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://learn.adafruit.com/cooperative-multitasking-in-circuitpython-with-asyncio/overview",children:"https://learn.adafruit.com/cooperative-multitasking-in-circuitpython-with-asyncio/overview"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://lastminuteengineers.com/handling-esp32-gpio-interrupts-tutorial/",children:"https://lastminuteengineers.com/handling-esp32-gpio-interrupts-tutorial/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://deepbluembedded.com/esp32-external-interrupts-pins-arduino-examples/",children:"https://deepbluembedded.com/esp32-external-interrupts-pins-arduino-examples/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.sparkfun.com/news/2613",children:"https://www.sparkfun.com/news/2613"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.sparkfun.com/news/2608",children:"https://www.sparkfun.com/news/2608"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.sparkfun.com/news/2577",children:"https://www.sparkfun.com/news/2577"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://descubrearduino.com/interrupciones-esp32-gpio/",children:"https://descubrearduino.com/interrupciones-esp32-gpio/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.electrogeekshop.com/esp32-arduino-interrupciones-timer-2/",children:"https://www.electrogeekshop.com/esp32-arduino-interrupciones-timer-2/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.arduino.cc/reference/en/language/functions/interrupts/interrupts/",children:"https://www.arduino.cc/reference/en/language/functions/interrupts/interrupts/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.arduino.cc/reference/en/language/functions/external-interrupts/attachinterrupt/",children:"https://www.arduino.cc/reference/en/language/functions/external-interrupts/attachinterrupt/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://controlautomaticoeducacion.com/arduino/interrupciones-arduino/",children:"https://controlautomaticoeducacion.com/arduino/interrupciones-arduino/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.theengineeringprojects.com/2021/12/esp32-interrupts.html",children:"https://www.theengineeringprojects.com/2021/12/esp32-interrupts.html"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"http://stefanfrings.de/multithreading_arduino/",children:"http://stefanfrings.de/multithreading_arduino/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://hackaday.com/2021/03/17/running-57-threads-at-once-on-the-arduino-uno/",children:"https://hackaday.com/2021/03/17/running-57-threads-at-once-on-the-arduino-uno/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.arduino.cc/reference/en/libraries/arduinothread/",children:"https://www.arduino.cc/reference/en/libraries/arduinothread/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.digikey.com/en/maker/blogs/2022/how-to-write-multi-threaded-arduino-programs",children:"https://www.digikey.com/en/maker/blogs/2022/how-to-write-multi-threaded-arduino-programs"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/ivanseidel/ArduinoThread",children:"https://github.com/ivanseidel/ArduinoThread"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://learn.adafruit.com/cooperative-multitasking-in-circuitpython-with-asyncio/overview",children:"https://learn.adafruit.com/cooperative-multitasking-in-circuitpython-with-asyncio/overview"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://wiki.seeedstudio.com/Wio-Terminal-TinyML-EI-4/",children:"https://wiki.seeedstudio.com/Wio-Terminal-TinyML-EI-4/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://wiki.seeedstudio.com/reServer-Getting-Started/",children:"https://wiki.seeedstudio.com/reServer-Getting-Started/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.seeedstudio.com/blog/2021/05/11/multitasking-with-arduino-millis-rtos-more/",children:"https://www.seeedstudio.com/blog/2021/05/11/multitasking-with-arduino-millis-rtos-more/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.hackster.io/485734/azure-rtos-threadx-for-arduino-101-threads-963a8d",children:"https://www.hackster.io/485734/azure-rtos-threadx-for-arduino-101-threads-963a8d"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://wiki.seeedstudio.com/reTerminal-build-UI-using-LVGL/",children:"https://wiki.seeedstudio.com/reTerminal-build-UI-using-LVGL/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.rt-thread.io/",children:"https://www.rt-thread.io/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.digikey.com/en/maker/tutorials/2022/how-to-use-arduino-interrupts-to-detect-user-inputs",children:"https://www.digikey.com/en/maker/tutorials/2022/how-to-use-arduino-interrupts-to-detect-user-inputs"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);